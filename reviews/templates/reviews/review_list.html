{% extends 'base.html' %}

{% block content %}
<main class="pt-24 pb-16 bg-background-light dark:bg-background-dark">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- Page Header -->
        <div class="mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">
                Community Reviews
            </h1>
            <p class="text-lg text-gray-600 dark:text-gray-400">
                Explore reviews from the developer community
            </p>
        </div>

        <!-- Reviews List -->
        <div class="space-y-6">
            {% if reviews %}
                {% for review in reviews %}
                <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 hover:shadow-lg transition-shadow duration-300">
                    
                    <!-- Review Header -->
                    <div class="flex items-start justify-between gap-4 mb-4">
                        <div class="flex-1">
                            <!-- Book Title Link -->
                            <a 
                                href="{% url 'book_detail' review.book.slug %}"
                                class="text-sm font-semibold text-primary hover:text-pink-600 transition-colors mb-1 inline-block"
                            >
                                {{ review.book.title }}
                            </a>
                            
                            <!-- Review Title -->
                            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">
                                {{ review.title }}
                            </h3>
                            
                            <!-- Author and Date -->
                            <div class="flex items-center gap-3">
                                <div class="flex items-center gap-2">
                                    <!-- User Avatar Initials -->
                                    <div class="flex items-center justify-center w-8 h-8 rounded-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold text-xs">
                                        {{ review.user.first_name|slice:":1"|upper|default:review.user.username|slice:":1"|upper }}
                                    </div>
                                    <div>
                                        <p class="text-sm font-semibold text-gray-900 dark:text-white">
                                            {{ review.user.get_full_name|default:review.user.username }}
                                        </p>
                                    </div>
                                </div>
                                <span class="text-sm text-gray-500 dark:text-gray-400">
                                    {{ review.created_at|date:"M d, Y" }}
                                </span>
                            </div>
                        </div>
                        
                        <!-- Rating Stars -->
                        <div class="flex gap-0.5 flex-shrink-0">
                            {% for i in "12345" %}
                                <span class="material-icons text-sm {% if forloop.counter <= review.rating %}text-yellow-400{% else %}text-gray-300 dark:text-gray-600{% endif %}">star</span>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Review Content -->
                    <p class="text-gray-700 dark:text-gray-300 leading-relaxed mb-4">
                        {{ review.content }}
                    </p>

                    <!-- Tech Stack Used (if available) -->
                    {% if review.tech_stack_used %}
                    <div class="mb-3 p-3 rounded bg-gray-100 dark:bg-gray-700/50 text-sm">
                        <span class="text-gray-600 dark:text-gray-300 flex items-center gap-2">
                            <span class="material-icons text-sm">code</span>
                            {{ review.tech_stack_used }}
                        </span>
                    </div>
                    {% endif %}

                    <!-- Recommended Badge -->
                    <div class="flex items-center gap-3">
                        {% if review.is_recommended %}
                        <span class="inline-flex items-center gap-1 px-3 py-1 rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs font-medium">
                            <span class="material-icons text-xs">check_circle</span>
                            Recommended
                        </span>
                        {% endif %}
                        
                        <!-- Link to Book Detail -->
                        <a 
                            href="{% url 'book_detail' review.book.slug %}"
                            class="ml-auto inline-flex items-center text-primary hover:text-pink-600 font-semibold text-sm transition-colors"
                        >
                            View Book
                            <span class="material-icons text-sm ml-1">arrow_forward</span>
                        </a>
                    </div>
                </div>
                {% endfor %}
            {% else %}
            <div class="text-center py-16">
                <span class="material-icons text-6xl text-gray-300 dark:text-gray-600 block mb-4">comment</span>
                <p class="text-gray-600 dark:text-gray-400 text-lg">No reviews yet. Be the first to review a book!</p>
            </div>
            {% endif %}
        </div>
    </div>
</main>
{% endblock %}
